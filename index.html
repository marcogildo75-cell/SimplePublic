<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>To-Do List con Matrice di Eisenhower Colorata</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    max-width: 900px;
    margin: auto;
    padding: 20px;
    background: #f0f4f8;
    color: #222;
  }
  h1 {
    text-align: center;
    color: #0055cc;
    margin-bottom: 10px;
  }
  .input-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
    margin-bottom: 20px;
  }
  input[type=text], select {
    padding: 10px;
    font-size: 16px;
    border: 1.5px solid #ccc;
    border-radius: 8px;
    min-width: 140px;
    transition: border-color 0.3s ease;
  }
  input[type=text]:focus, select:focus {
    border-color: #0055cc;
    outline: none;
  }
  button {
    padding: 10px 20px;
    font-size: 16px;
    color: white;
    background-color: #0055cc;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    flex-shrink: 0;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #003d99;
  }
  #filter-row {
    text-align: center;
    margin-bottom: 15px;
  }
  select#filterCategory {
    margin-left: 8px;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
  .legend {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
    flex-wrap: wrap;
    gap: 15px;
  }
  .legend-item {
    display: flex;
    align-items: center;
    font-size: 14px;
    user-select: none;
  }
  .color-box {
    width: 18px;
    height: 18px;
    border-radius: 4px;
    margin-right: 6px;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
  }

  /* Colori categorie */
  .cat-Personale { background-color: #4caf50; } /* Verde */
  .cat-Famiglia { background-color: #ff9800; }  /* Arancio */
  .cat-Lavoro { background-color: #2196f3; }    /* Blu */
  .cat-Salute { background-color: #e91e63; }    /* Rosa */
  .cat-Finanze { background-color: #9c27b0; }   /* Viola */

  /* Matrice */
  .matrix {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 25px;
    margin-top: 20px;
  }
  .quadrant {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    min-height: 280px;
    display: flex;
    flex-direction: column;
  }
  .quadrant h3 {
    background-color: #0055cc;
    color: white;
    margin: 0;
    padding: 12px 20px;
    font-size: 18px;
    border-radius: 12px 12px 0 0;
    text-align: center;
    box-shadow: inset 0 -3px 8px rgba(0,0,0,0.3);
  }

  ul {
    list-style: none;
    padding: 15px 20px;
    margin: 0;
    overflow-y: auto;
    flex-grow: 1;
  }
  li {
    background: #f9faff;
    padding: 12px 14px;
    margin-bottom: 12px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  li:hover {
    background-color: #e0ebff;
  }
  li.completed {
    text-decoration: line-through;
    color: #999;
    background-color: #ddd;
    cursor: default;
  }
  .color-indicator {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    flex-shrink: 0;
    margin-right: 12px;
    box-shadow: 0 0 5px rgba(0,0,0,0.15);
  }
  .task-text {
    flex-grow: 1;
    font-size: 16px;
  }
  .task-info {
    font-size: 12px;
    color: #555;
    margin-left: 10px;
    white-space: nowrap;
  }
  button.deleteBtn {
    background: #ff3b30;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 6px 10px;
    cursor: pointer;
    margin-left: 15px;
    flex-shrink: 0;
    transition: background-color 0.2s ease;
  }
  button.deleteBtn:hover {
    background-color: #cc2a22;
  }

  /* Scroll bar personalizzata */
  ul::-webkit-scrollbar {
    width: 8px;
  }
  ul::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  ul::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 4px;
  }
  ul::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
  }

  /* Responsive */
  @media (max-width: 700px) {
    .input-row {
      flex-direction: column;
      align-items: center;
    }
    input[type=text], select, button {
      width: 90%;
      max-width: 300px;
      margin-bottom: 10px;
    }
  }
</style>
</head>
<body>

<h1>To-Do List Avanzata</h1>

<div class="input-row">
  <input type="text" id="newTask" placeholder="Aggiungi nuova attività..." aria-label="Nuova attività" />

  <select id="newCategory" title="Categoria" aria-label="Categoria">
    <option value="Personale">Personale</option>
    <option value="Famiglia">Famiglia</option>
    <option value="Lavoro">Lavoro</option>
    <option value="Salute">Salute</option>
    <option value="Finanze">Finanze</option>
  </select>

  <select id="newUrgency" title="Urgenza" aria-label="Urgenza">
    <option value="Urgente">Urgente</option>
    <option value="Non urgente" selected>Non urgente</option>
  </select>
  
  <select id="newImportance" title="Importanza" aria-label="Importanza">
    <option value="Importante">Importante</option>
    <option value="Non importante" selected>Non importante</option>
  </select>

  <button id="addBtn" aria-label="Aggiungi attività">Aggiungi</button>
</div>

<div id="filter-row">
  <label for="filterCategory">Filtra per categoria:</label>
  <select id="filterCategory" aria-label="Filtra per categoria">
    <option value="Tutte">Tutte</option>
    <option value="Personale">Personale</option>
    <option value="Famiglia">Famiglia</option>
    <option value="Lavoro">Lavoro</option>
    <option value="Salute">Salute</option>
    <option value="Finanze">Finanze</option>
  </select>
</div>

<div class="legend" aria-label="Legenda categorie">
  <div class="legend-item"><span class="color-box cat-Personale"></span>Personale</div>
  <div class="legend-item"><span class="color-box cat-Famiglia"></span>Famiglia</div>
  <div class="legend-item"><span class="color-box cat-Lavoro"></span>Lavoro</div>
  <div class="legend-item"><span class="color-box cat-Salute"></span>Salute</div>
  <div class="legend-item"><span class="color-box cat-Finanze"></span>Finanze</div>
</div>

<div class="matrix" role="region" aria-label="Matrice di Eisenhower">
  <div class="quadrant" id="q1" aria-labelledby="q1-title" tabindex="0" role="region">
    <h3 id="q1-title">Urgente & Importante</h3>
    <ul></ul>
  </div>
  <div class="quadrant" id="q2" aria-labelledby="q2-title" tabindex="0" role="region">
    <h3 id="q2-title">Non Urgente & Importante</h3>
    <ul></ul>
  </div>
  <div class="quadrant" id="q3" aria-labelledby="q3-title" tabindex="0" role="region">
    <h3 id="q3-title">Urgente & Non Importante</h3>
    <ul></ul>
  </div>
  <div class="quadrant" id="q4" aria-labelledby="q4-title" tabindex="0" role="region">
    <h3 id="q4-title">Non Urgente & Non Importante</h3>
    <ul></ul>
  </div>
</div>

<script>
  const newTaskInput = document.getElementById('newTask');
  const addBtn = document.getElementById('addBtn');
  const filterCategory = document.getElementById('filterCategory');

  let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

  function saveTasks() {
    localStorage.setItem('tasks', JSON.stringify(tasks));
  }

  function createTaskElement(task, index) {
    const li = document.createElement('li');
    if (task.done) li.classList.add('completed');

    // Indicatore colore categoria
    const colorInd = document.createElement('span');
    colorInd.className = 'color-indicator cat-' + task.category.replace(/\s+/g, '');
    colorInd.title = task.category;
    li.appendChild(colorInd);

    // Testo attività
    const span = document.createElement('span');
    span.className = 'task-text';
    span.textContent = task.text;
    li.appendChild(span);

    // Categoria info
    const info = document.createElement('span');
    info.className = 'task-info';
    info.textContent = `[${task.category}]`;
    li.appendChild(info);

    // Toggle completamento attività
    li.addEventListener('click', () => {
      tasks[index].done = !tasks[index].done;
      saveTasks();
      renderTasks();
    });

    // Bottone elimina
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'deleteBtn';
    deleteBtn.textContent = 'Elimina';
    deleteBtn.title = 'Elimina attività';
    deleteBtn.addEventListener('click', e => {
      e.stopPropagation();
      tasks.splice(index, 1);
      saveTasks();
      renderTasks();
    });
    li.appendChild(deleteBtn);

    return li;
  }

  function getQuadrant(task) {
    const urgent = task.urgency === 'Urgente';
    const important = task.importance === 'Importante';
    if (urgent && important) return 'q1';
    if (!urgent && important) return 'q2';
    if (urgent && !important) return 'q3';
    return 'q4';
  }

  function renderTasks() {
    ['q1','q2','q3','q4'].forEach(id => {
      document.getElementById(id).querySelector('ul').innerHTML = '';
    });

    const filtered = tasks.filter(task => 
      filterCategory.value === 'Tutte' || task.category === filterCategory.value
    );

    filtered.forEach(task => {
      const quadrantId = getQuadrant(task);
      const ul = document.getElementById(quadrantId).querySelector('ul');
      ul.appendChild(createTaskElement(task, tasks.indexOf(task)));
    });
  }

  addBtn.addEventListener('click', () => {
    const text = newTaskInput.value.trim();
    if (!text) return alert('Inserisci un\'attività valida');

    const category = document.getElementById('newCategory').value;
    const urgency = document.getElementById('newUrgency').value;
    const importance = document.getElementById('newImportance').value;

    tasks.push({
      text,
      category,
      urgency,
      importance,
      done: false,
      created: Date.now()
    });

    saveTasks();
    newTaskInput.value = '';
    renderTasks();
  });

  filterCategory.addEventListener('change', renderTasks);

  renderTasks();
</script>

</body>
</html>
